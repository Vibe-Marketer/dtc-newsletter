---
phase: 02-documentation-restructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - REFERENCE.md
autonomous: true

must_haves:
  truths:
    - "REFERENCE.md exists with consolidated framework documentation"
    - "All content from FRAMEWORK.md is preserved in REFERENCE.md"
    - "All content from ARCHITECTURE.md is preserved in REFERENCE.md"
    - "Unique content from SETUP.md and QUICKSTART.md is preserved"
    - "REFERENCE.md has a navigable table of contents"
  artifacts:
    - path: "REFERENCE.md"
      provides: "Consolidated deep-dive documentation"
      min_lines: 400
      contains: "## Table of Contents"
  key_links:
    - from: "REFERENCE.md"
      to: "FRAMEWORK.md content"
      via: "Content migration"
      pattern: "Error Classification|Escalation Thresholds|Rollback Protocol"
    - from: "REFERENCE.md"
      to: "ARCHITECTURE.md content"
      via: "Content migration"
      pattern: "Self-Improvement Loop|Version Tags"
---

<objective>
Create REFERENCE.md by consolidating content from FRAMEWORK.md, ARCHITECTURE.md, and unique content from SETUP.md/QUICKSTART.md.

Purpose: This is the foundation for doc consolidation. REFERENCE.md becomes the single deep-dive document, replacing 4+ scattered files. Must be complete before we can update README to link to it.

Output: A comprehensive REFERENCE.md file (~500-600 lines) with table of contents, organized by topic not by source file.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-documentation-restructure/02-RESEARCH.md

# Source files for content migration
@FRAMEWORK.md
@ARCHITECTURE.md
@SETUP.md
@QUICKSTART.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Analyze source files and document content map</name>
  <files>None (analysis output to terminal)</files>
  <action>
  Read and compare FRAMEWORK.md, ARCHITECTURE.md, SETUP.md, and QUICKSTART.md to identify:

  1. **Duplicate content** - Same information in multiple files (keep ONE copy in REFERENCE.md)
  2. **Unique content per file** - Content that only appears in one file (preserve all)
  3. **Conflicting content** - Same topic but different details (resolve in favor of FRAMEWORK.md which is more detailed)

  **Output a content map to terminal** (this output will be used to verify analysis is complete):

  ```
  === CONTENT MAP FOR REFERENCE.md ===

  FROM FRAMEWORK.md:
  - Section: [name] -> REFERENCE.md: [target section]
  - Section: [name] -> REFERENCE.md: [target section]
  ...

  FROM ARCHITECTURE.md:
  - Section: [name] -> REFERENCE.md: [target section]
  ...

  FROM SETUP.md:
  - Section: [name] -> REFERENCE.md: [target section] (or SKIP: [reason])
  ...

  FROM QUICKSTART.md:
  - Section: [name] -> REFERENCE.md: [target section] (or SKIP: [reason])
  ...

  DUPLICATES TO REMOVE:
  - [topic] appears in [files] -> keeping version from [file]
  ...

  === END CONTENT MAP ===
  ```

  Expected mappings:
  - FRAMEWORK.md: Error Classification, Escalation Thresholds, Routing Logic, Validation Protocol, Cost Tracking, Creating New Workflows, Rollback Protocol, File Conventions, Version Control - ALL unique, keep everything
  - ARCHITECTURE.md: ASCII diagrams, "30 seconds" explanation, Self-Improvement Loop diagram, Required vs Optional tables - keep visual elements
  - SETUP.md: Step-by-step setup (SKIP - goes in README), troubleshooting section (KEEP)
  - QUICKSTART.md: "Tips" section at end (KEEP if not covered elsewhere)

  DO NOT write any files yet. This is analysis to inform Task 2.
  </action>
  <verify>Terminal output contains "=== CONTENT MAP FOR REFERENCE.md ===" and "=== END CONTENT MAP ===" with at least 10 section mappings listed</verify>
  <done>Content map printed to terminal showing source -> destination for all sections from all 4 source files</done>
</task>

<task type="auto">
  <name>Task 2: Create REFERENCE.md with consolidated content</name>
  <files>REFERENCE.md</files>
  <action>
  Create REFERENCE.md with the following structure (organized by topic, not by source):

  ```markdown
  # Agentic Workflows Reference
  ## Deep Documentation for the DOE Framework

  > Everything you need to understand and extend the framework.

  ---

  ## Table of Contents

  1. [Architecture Overview](#architecture-overview)
  2. [Directory Structure](#directory-structure)
  3. [Agent Files (CLAUDE.md, AGENTS.md, GEMINI.md)](#agent-files)
  4. [Creating New Workflows](#creating-new-workflows)
  5. [Version Control Protocol](#version-control-protocol)
  6. [Error Classification](#error-classification)
  7. [Escalation Thresholds](#escalation-thresholds)
  8. [Routing Logic](#routing-logic)
  9. [Validation Protocol](#validation-protocol)
  10. [Cost Tracking](#cost-tracking)
  11. [Rollback Protocol](#rollback-protocol)
  12. [File Conventions](#file-conventions)
  13. [Self-Improvement Loop](#self-improvement-loop)
  14. [Environment Setup](#environment-setup)
  15. [Troubleshooting](#troubleshooting)
  16. [Quick Reference](#quick-reference)

  ---
  ```

  **Content migration rules:**
  - From FRAMEWORK.md: Include ALL sections verbatim (this is the most detailed source)
  - From ARCHITECTURE.md: Include ASCII diagrams and visual elements that FRAMEWORK.md lacks
  - From SETUP.md: Extract "Troubleshooting" section, merge into Troubleshooting
  - From QUICKSTART.md: Extract "Tips" section if unique, add to Quick Reference

  **Do NOT include:**
  - Step-by-step setup instructions (those go in README)
  - Migration instructions (not needed for template)
  - Duplicate explanations of the same concept

  **Formatting:**
  - Use consistent heading levels (## for main sections, ### for subsections)
  - Preserve code blocks exactly as-is
  - Keep ASCII diagrams intact
  - Add "---" separators between major sections for readability
  </action>
  <verify>
  1. `wc -l REFERENCE.md` shows 400+ lines
  2. `grep -c "^## " REFERENCE.md` shows 10+ section headings
  3. `grep "Table of Contents" REFERENCE.md` finds the TOC
  4. `grep "Error Classification" REFERENCE.md` finds the section
  5. `grep "Self-Improvement Loop" REFERENCE.md` finds the section
  </verify>
  <done>
  - REFERENCE.md exists with 400+ lines
  - Has Table of Contents linking to all major sections
  - Contains all Error Classification content from FRAMEWORK.md
  - Contains ASCII architecture diagram from ARCHITECTURE.md
  - Contains Self-Improvement Loop from ARCHITECTURE.md
  - Contains Troubleshooting tips consolidated from SETUP.md
  </done>
</task>

</tasks>

<verification>
After completing all tasks, verify:

1. **Content completeness:**
   ```bash
   # Check REFERENCE.md has key sections from each source
   grep -E "Error Classification|Escalation|Routing Logic" REFERENCE.md
   grep -E "Self-Improvement Loop" REFERENCE.md
   grep -E "Troubleshooting" REFERENCE.md
   ```

2. **File size is appropriate:**
   ```bash
   wc -l REFERENCE.md  # Should be 400-700 lines
   ```

3. **No broken internal links:**
   ```bash
   # Extract anchor links and verify sections exist
   grep -oE '\(#[a-z-]+\)' REFERENCE.md | sort -u
   ```
</verification>

<success_criteria>
1. REFERENCE.md exists with 400+ lines of consolidated content
2. Table of Contents has 10+ entries with working anchor links
3. All unique content from FRAMEWORK.md preserved
4. ASCII diagrams from ARCHITECTURE.md preserved
5. Troubleshooting tips from SETUP.md included
6. No duplicate content (each concept explained once)
7. Sections organized by topic, not by original source file
</success_criteria>

<output>
After completion, create `.planning/phases/02-documentation-restructure/02-01-SUMMARY.md`
</output>
